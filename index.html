<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  <title>Ù†Ø¸Ø§Ù… Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</title>
Â  <script src="https://cdn.tailwindcss.com"></script>
Â  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
</head>
<body class="bg-fixed bg-cover bg-center text-gray-900" style="background-image: url('bg.png');">
Â  
Â  Â  <div class="bg-white shadow-lg rounded-2xl p-4 w-full max-w-md mx-auto text-center mb-6 animate__animated animate__fadeInDown">
Â  Â  <h1 class="text-3xl font-bold text-indigo-700">
Â  Â  Â  ğŸ§¬Ù…Ù†ØµØ© Ø§Ù„Ø®ÙŠÙ…ÙŠØ§Ø¦ÙŠ<br>
Â  Â  Â  ğŸ“˜ Ù†Ø¸Ø§Ù… Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ù„Ø§Ø¨
Â  Â  </h1>
Â  </div>

Â  Â  <div class="bg-white shadow-lg rounded-2xl p-4 w-full max-w-md mx-auto mb-6 animate__animated animate__fadeInUp">
Â  Â  <label for="studentCode" class="block mb-2 text-lg font-semibold text-gray-700">Ø§Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø·Ø§Ù„Ø¨:</label>
Â  Â  <input id="studentCode" type="text" 
Â  Â  Â  class="w-full border border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-indigo-400 focus:outline-none mb-3">
Â  Â  <button onclick="searchStudent()" 
Â  Â  Â  class="w-full bg-indigo-600 text-white py-2 rounded-lg hover:bg-indigo-700 transition">
Â  Â  Â  ğŸ” Ø¨Ø­Ø«
Â  Â  </button>
Â  </div>

Â  Â  <div id="studentInfo" class="w-full max-w-2xl bg-white shadow-md rounded-2xl p-4 mx-auto animate__animated animate__fadeIn"></div>

Â  Â  <button onclick="openVideosModal()" class="bg-white shadow-lg rounded-2xl p-4 w-full max-w-md mx-auto text-center mt-8 mb-4 hover:bg-indigo-50 transition block">
Â  Â  <h2 class="text-xl font-bold text-indigo-700">ğŸ¬ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª</h2>
Â  </button>

Â  Â  <button onclick="openContactsModal()" class="bg-white shadow-lg rounded-2xl p-4 w-full max-w-md mx-auto text-center mt-8 mb-4 hover:bg-green-50 transition block">
Â  Â  <h2 class="text-xl font-bold text-indigo-700">ğŸ“ ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„</h2>
Â  </button>

Â  Â  <div id="videosModal" class="fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center z-50">
Â  Â  <div class="bg-white rounded-2xl p-6 w-full max-w-lg shadow-lg relative animate__animated animate__fadeInUp max-h-[90vh] overflow-hidden">
Â  Â  Â  <button onclick="closeVideosModal()" class="absolute top-2 left-2 text-red-600 font-bold text-xl">âœ–</button>
Â  Â  Â  <h2 class="text-2xl font-bold text-indigo-700 mb-4 text-center">ğŸ“½ï¸ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª</h2>
Â  Â  Â  <select id="videoClassSelect" class="w-full border p-2 rounded mb-4 text-gray-700" onchange="filterVideosByClass()">
Â  Â  Â  Â  <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ</option>
Â  Â  Â  </select>
Â  Â  Â  <div id="videosContainer" class="grid gap-3 overflow-y-auto max-h-80"></div>
Â  Â  </div>
Â  </div>

Â  Â  <div id="contactsModal" class="fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center z-50">
Â  Â  <div class="bg-white rounded-2xl p-6 w-full max-w-lg shadow-lg relative animate__animated animate__fadeInUp">
Â  Â  Â  <button onclick="closeContactsModal()" class="absolute top-2 left-2 text-red-600 font-bold text-xl">âœ–</button>
Â  Â  Â  <h2 class="text-2xl font-bold text-indigo-700 mb-4 text-center">ğŸ“ ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„</h2>
Â  Â  Â  <div id="contactsContainer" class="grid gap-3"></div>
Â  Â  </div>
Â  </div>

Â  <script>
Â  Â  const SHEET_STUDENTS = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRj2ajSLPIBsAwHwv8qSVX7_5q5I_LATlqKEWkzOIdF_3Em9PmTTWZ8BnXNau0yCNeF1XAx9KX3PLrN/pub?gid=635336311&single=true&output=csv";
Â  Â  const SHEET_VIDEOS Â  = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRj2ajSLPIBsAwHwv8qSVX7_5q5I_LATlqKEWkzOIdF_3Em9PmTTWZ8BnXNau0yCNeF1XAx9KX3PLrN/pub?gid=849351073&single=true&output=csv";
Â  Â  const SHEET_CONTACTS = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRj2ajSLPIBsAwHwv8qSVX7_5q5I_LATlqKEWkzOIdF_3Em9PmTTWZ8BnXNau0yCNeF1XAx9KX3PLrN/pub?gid=218257892&single=true&output=csv";

Â  Â  async function fetchCSV(url) {
Â  Â  Â  const res = await fetch(url);
Â  Â  Â  const text = await res.text();
Â  Â  Â  const rows = text.trim().split("\n").map(r => r.split(","));
Â  Â  Â  const headers = rows[0].map(h => h.trim());
Â  Â  Â  return rows.slice(1).map(row => {
Â  Â  Â  Â  let obj = {};
Â  Â  Â  Â  headers.forEach((h, i) => obj[h] = row[i] ? row[i].trim() : "");
Â  Â  Â  Â  return obj;
Â  Â  Â  });
Â  Â  }

Â  Â  function safeNumber(val) {
Â  Â  Â  return (val === "" || isNaN(parseFloat(val))) ? 0 : parseFloat(val);
Â  Â  }

Â  Â  // Helper: consider a sheet cell empty when it's empty string, null, undefined or spaces-only
Â  Â  function isEmptyCell(val) {
Â  Â  Â  return val === null || val === undefined || (typeof val === 'string' && val.trim() === '');
Â  Â  }

Â  Â  // For display: if the original raw cell is empty show '-' else show the numeric value
Â  Â  function displayFromRaw(raw, numeric) {
Â  Â  Â  return isEmptyCell(raw) ? '-' : numeric;
Â  Â  }

Â  Â  async function searchStudent() {
Â  Â  Â  const code = document.getElementById("studentCode").value.trim();
Â  Â  Â  if (!code) {
Â  Â  Â  Â  document.getElementById("studentInfo").innerHTML = `<p class="text-red-600 font-bold">Ø§ÙƒØªØ¨ ÙƒÙˆØ¯ Ø§Ù„Ø·Ø§Ù„Ø¨</p>`;
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  const students = await fetchCSV(SHEET_STUDENTS);
Â  Â  Â  const student = students.find(s => (s.code || "") === code);

Â  Â  Â  if (!student) {
Â  Â  Â  Â  document.getElementById("studentInfo").innerHTML =
Â  Â  Â  Â  Â  `<p class="text-red-600 font-bold">âš ï¸ Ø§Ù„Ø·Ø§Ù„Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯</p>`;
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  const w1_exam = safeNumber(student.w1_exam);
Â  Â  Â  const w1_homework = safeNumber(student.w1_homework);
Â  Â  Â  const w1_tesmie3 = safeNumber(student.w1_tesmie3);
Â  Â  Â  const w2_exam = safeNumber(student.w2_exam);
Â  Â  Â  const w2_homework = safeNumber(student.w2_homework);
Â  Â  Â  const w2_tesmie3 = safeNumber(student.w2_tesmie3);
Â  Â  Â  const w3_exam = safeNumber(student.w3_exam);
Â  Â  Â  const w3_homework = safeNumber(student.w3_homework);
Â  Â  Â  const w3_tesmie3 = safeNumber(student.w3_tesmie3);
Â  Â  Â  const w4_exam = safeNumber(student.w4_exam);
Â  Â  Â  const w4_homework = safeNumber(student.w4_homework);
Â  Â  Â  const w4_tesmie3 = safeNumber(student.w4_tesmie3);
Â  Â  Â  const finalExam = safeNumber(student.finalExam);

Â  Â  Â  const total = w1_exam + w1_homework + w1_tesmie3 +
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  w2_exam + w2_homework + w2_tesmie3 +
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  w3_exam + w3_homework + w3_tesmie3 +
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  w4_exam + w4_homework + w4_tesmie3 +
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  finalExam;

Â  Â  Â  const maxTotal = (4 * 10) + (4 * 10) + (4 * 10) + 20;
Â  Â  Â  const percent = ((total / maxTotal) * 100).toFixed(2);
Â  Â  Â  const percentClass = percent >= 75 ? "text-green-700" : percent >= 50 ? "text-yellow-700" : "text-red-700";

Â  Â  Â  document.getElementById("studentInfo").innerHTML = `
Â  Â  Â  Â  <h2 class="text-2xl font-bold text-indigo-700 mb-4">ğŸ“„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨</h2>
Â  Â  Â  Â  <p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> ${student.name || "-"}</p>
Â  Â  Â  Â  <p><strong>Ø§Ù„ØµÙ:</strong> ${student.class || "-"}</p>
Â  Â  Â  Â  <p><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©:</strong> ${student.group || "-"}</p>
Â  Â  Â  Â  <h3 class="text-xl font-semibold text-gray-700 mt-4 mb-2">ğŸ“Š Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</h3>
Â  Â  Â  Â  <div class="overflow-x-auto">
Â  Â  Â  Â  Â  <table class="w-full border border-gray-300 rounded-lg overflow-hidden text-center">
Â  Â  Â  Â  Â  Â  <thead class="bg-indigo-600 text-white">
Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  <th class="p-2">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</th>
Â  Â  Â  Â  Â  Â  Â  Â  <th class="p-2">Ø§Ù…ØªØ­Ø§Ù† (10)</th>
Â  Â  Â  Â  Â  Â  Â  Â  <th class="p-2">ÙˆØ§Ø¬Ø¨ (10)</th>
Â  Â  Â  Â  Â  Â  Â  Â  <th class="p-2">ØªØ³Ù…ÙŠØ¹ (10)</th>
Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  Â  <tbody>
Â  Â  Â  Â  Â  Â  Â  <tr class="border-b"><td>1</td><td>${displayFromRaw(student.w1_exam, w1_exam)}</td><td>${displayFromRaw(student.w1_homework, w1_homework)}</td><td>${displayFromRaw(student.w1_tesmie3, w1_tesmie3)}</td></tr>
Â  Â  Â  Â  Â  Â  Â  <tr class="border-b bg-gray-50"><td>2</td><td>${displayFromRaw(student.w2_exam, w2_exam)}</td><td>${displayFromRaw(student.w2_homework, w2_homework)}</td><td>${displayFromRaw(student.w2_tesmie3, w2_tesmie3)}</td></tr>
Â  Â  Â  Â  Â  Â  Â  <tr class="border-b"><td>3</td><td>${displayFromRaw(student.w3_exam, w3_exam)}</td><td>${displayFromRaw(student.w3_homework, w3_homework)}</td><td>${displayFromRaw(student.w3_tesmie3, w3_tesmie3)}</td></tr>
Â  Â  Â  Â  Â  Â  Â  <tr class="border-b bg-gray-50"><td>4</td><td>${displayFromRaw(student.w4_exam, w4_exam)}</td><td>${displayFromRaw(student.w4_homework, w4_homework)}</td><td>${displayFromRaw(student.w4_tesmie3, w4_tesmie3)}</td></tr>
Â  Â  Â  Â  Â  Â  </tbody>
Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  </div>
Â  <p class="mt-4 font-semibold">Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„Ø´Ø§Ù…Ù„: <span class="text-indigo-700">${isEmptyCell(student.finalExam) ? '-' : finalExam + '/20'}</span></p>
Â  Â  Â  Â  <p class="mt-2 font-bold ${percentClass}">Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: ${percent}%</p>
Â  Â  Â  `;
Â  Â  }

Â  Â  let videosData = [];

Â  Â  async function openVideosModal() {
Â  Â  Â  document.getElementById("videosModal").classList.remove("hidden");
Â  Â  Â  const videos = await fetchCSV(SHEET_VIDEOS);
Â  Â  Â  videosData = videos;
Â  Â  Â  const classes = [...new Set(videos.map(v => v.class).filter(v => v))];
Â  Â  Â  const select = document.getElementById("videoClassSelect");
Â  Â  Â  select.innerHTML = `<option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ</option>` + classes.map(c => `<option value="${c}">${c}</option>`).join("");
Â  Â  Â  // Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø© Ù„Ø£ÙˆÙ„ Ù…Ø±Ø©
Â  Â  Â  filterVideosByClass(); 
Â  Â  }

Â  Â  function closeVideosModal() {
Â  Â  Â  document.getElementById("videosModal").classList.add("hidden");
Â  Â  }

Â  Â  function filterVideosByClass() {
Â  Â  Â  const selected = document.getElementById("videoClassSelect").value;
Â  Â  Â  const container = document.getElementById("videosContainer");
Â  Â  Â  // ÙÙŠ Ø­Ø§Ù„Ø© Ø¹Ø¯Ù… Ø§Ø®ØªÙŠØ§Ø± ØµÙØŒ Ù†Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª
Â  Â  Â  const filtered = selected === "" ? videosData : videosData.filter(v => v.class === selected);
Â  Â  Â  Â  Â  Â  
Â  Â  Â  if (filtered.length === 0) {
Â  Â  Â  Â  container.innerHTML = `<p class="text-gray-500 text-center mt-4">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„ØµÙ Ø­Ø§Ù„ÙŠÙ‹Ø§.</p>`;
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  container.innerHTML = filtered.map(v => `
Â  Â  Â  Â  <div class="bg-white shadow rounded-lg p-3 border hover:bg-indigo-50 transition">
Â  Â  Â  Â  Â  <p class="font-semibold text-indigo-700">${v.title}</p>
Â  Â  Â  Â  Â  <p class="text-sm text-gray-600">${v.note || ""}</p>
Â  Â  Â  Â  Â  <a href="${v.link}" target="_blank" class="text-blue-600 underline">Ù…Ø´Ø§Ù‡Ø¯Ø©</a>
Â  Â  Â  Â  </div>
Â  Â  Â  `).join("");
Â  Â  }

Â  Â  async function openContactsModal() {
Â  Â  Â  document.getElementById("contactsModal").classList.remove("hidden");
Â  Â  Â  const contacts = await fetchCSV(SHEET_CONTACTS);
Â  Â  Â  const container = document.getElementById("contactsContainer");
Â  Â  Â  container.innerHTML = contacts.map(c => {
Â  Â  Â  Â  let link = (c.type === "whatsapp") ? `https://wa.me/${c.number}` : `tel:${c.number}`;
Â  Â  Â  Â  return `
Â  Â  Â  Â  Â  <div class="bg-white shadow rounded-lg p-3 border hover:bg-green-50 transition">
Â  Â  Â  Â  Â  Â  <p class="font-semibold">${c.label}</p>
Â  Â  Â  Â  Â  Â  <a href="${link}" target="_blank" class="text-green-600 underline">ØªÙˆØ§ØµÙ„</a>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  `;
Â  Â  Â  }).join("");
Â  Â  }

Â  Â  function closeContactsModal() {
Â  Â  Â  document.getElementById("contactsModal").classList.add("hidden");
Â  Â  }
Â  </script>
</body>
</html>
